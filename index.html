<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Ampao Hunt: 3 Guesses!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@600;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background: radial-gradient(circle at center, #fff1f2 0%, #ffe4e6 100%);
            overflow-x: hidden;
            overscroll-behavior: none; 
            padding-bottom: 100px; /* Space for fixed footer on mobile if needed, or just general breathing room */
        }

        h1, h2, .quirky-font {
            font-family: 'Fredoka One', cursive;
        }

        /* Ampao Container Perspective */
        .scene {
            perspective: 1000px;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        /* The Ampao (Envelope) */
        .ampao {
            width: 100px; /* Smaller for 20 items */
            height: 150px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            cursor: pointer;
        }

        /* Responsive sizing */
        @media (min-width: 640px) {
            .ampao { width: 120px; height: 180px; }
        }
        @media (min-width: 1024px) {
            .ampao { width: 130px; height: 195px; }
        }

        .ampao:hover {
            transform: translateY(-10px) rotate(2deg);
        }

        .ampao.opened {
            transform: rotateY(180deg) scale(1.05);
            pointer-events: none;
        }

        .ampao.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
            filter: grayscale(0.8);
        }

        /* Front of Envelope */
        .ampao-front {
            position: absolute;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 8px;
            border: 2px solid #fca5a5;
            backface-visibility: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px -2px rgba(220, 38, 38, 0.3);
            z-index: 2;
        }

        /* Gold decoration */
        .gold-seal {
            width: 35px;
            height: 35px;
            background: radial-gradient(circle, #fcd34d 0%, #d97706 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: #92400e;
            border: 2px solid #fef3c7;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .pattern {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.1;
            background-image: radial-gradient(#fcd34d 2px, transparent 2px);
            background-size: 10px 10px;
        }

        /* Back/Inside of Envelope (The Reveal) */
        .ampao-back {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #fff;
            border-radius: 8px;
            backface-visibility: hidden;
            transform: rotateY(180deg);
            border: 2px solid #fcd34d;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px -2px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        /* Money Bill Style */
        .money-bill {
            width: 85%;
            height: 85%;
            background: #d1fae5;
            border: 2px dashed #059669;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #065f46;
            transform: translateY(100%);
            transition: transform 0.5s 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        /* Different colors for different amounts */
        .bill-low { background: #f3f4f6; border-color: #9ca3af; color: #4b5563; } /* Gray for 1/5/10 */
        .bill-mid { background: #dbeafe; border-color: #2563eb; color: #1e40af; } /* Blue for 20/50 */
        .bill-high { background: #d1fae5; border-color: #059669; color: #065f46; } /* Green for 100/200/500 */

        .ampao.opened .money-bill {
            transform: translateY(0);
        }

        /* Modal & Effects */
        #celebration-overlay {
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(4px);
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        .floater { animation: float 6s ease-in-out infinite; }
        .floater-delay { animation: float 7s ease-in-out 1s infinite; }

        /* Scoreboard Pulse */
        @keyframes scorePulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); color: #16a34a; }
            100% { transform: scale(1); }
        }
        .score-update { animation: scorePulse 0.3s ease-in-out; }

    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-6 text-gray-800 relative selection:bg-red-200">

    <!-- Background Decoration -->
    <div class="fixed top-10 left-10 text-4xl opacity-20 floater pointer-events-none">üßß</div>
    <div class="fixed bottom-20 right-10 text-6xl opacity-20 floater-delay pointer-events-none">üí∞</div>
    <div class="fixed top-1/2 left-4 text-3xl opacity-20 animate-bounce pointer-events-none">‚ú®</div>
    <div class="fixed top-20 right-1/4 text-5xl opacity-10 rotate-12 pointer-events-none">üéê</div>

    <!-- Sticky Scoreboard -->
    <div class="sticky top-4 z-40 bg-white/95 backdrop-blur shadow-lg rounded-2xl px-6 py-3 mb-6 flex items-center justify-between w-[90%] max-w-lg border-2 border-red-100">
        <div class="flex flex-col">
            <span class="text-xs text-gray-500 font-bold uppercase tracking-wider">Guesses Left</span>
            <div class="flex gap-1 mt-1" id="guesses-container">
                <span class="text-xl">üßß</span><span class="text-xl">üßß</span><span class="text-xl">üßß</span>
            </div>
        </div>
        <div class="text-right">
            <span class="text-xs text-gray-500 font-bold uppercase tracking-wider">Total Won</span>
            <div class="text-3xl font-black text-green-600 leading-none" id="total-display">‚Ç±0</div>
        </div>
    </div>

    <!-- Header -->
    <div class="text-center z-10 mb-6 px-4">
        <h1 class="text-3xl md:text-5xl text-red-600 mb-2 drop-shadow-sm">Pick 3 Ampaos!</h1>
        <p class="text-sm md:text-base text-gray-600 font-medium">
            20 envelopes. Prizes from ‚Ç±1 to ‚Ç±500.<br>
            <span class="text-red-500 font-bold">Accumulate your winnings!</span>
        </p>
    </div>

    <!-- Game Grid -->
    <div class="container max-w-5xl px-4 mb-12">
        <!-- Rendered by JS -->
        <div id="game-grid" class="grid grid-cols-4 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-5 gap-3 sm:gap-4 md:gap-6 justify-items-center">
            <!-- Ampaos inserted here -->
        </div>
    </div>

    <!-- Celebration Modal -->
    <div id="celebration-overlay" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4 opacity-0 transition-opacity duration-500">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-8 max-w-sm w-full text-center transform scale-90 transition-transform duration-300 relative overflow-hidden" id="modal-content">
            <!-- Background glow for modal -->
            <div id="modal-bg-glow" class="absolute inset-0 opacity-10"></div>

            <div class="relative z-10">
                <div class="text-6xl mb-4 animate-bounce" id="emoji-result">üéâ</div>
                <h2 class="text-2xl md:text-3xl text-red-500 mb-2 font-black" id="result-title">Game Over!</h2>
                <p class="text-gray-500 mb-6 font-medium" id="quirky-message">Let's see what you got!</p>
                
                <div class="bg-gray-50 rounded-xl p-6 mb-6 border-2 border-gray-100 dashed">
                    <span class="block text-xs text-gray-400 uppercase font-bold tracking-wider">Total Winnings</span>
                    <span class="text-5xl font-black text-gray-800 drop-shadow-sm" id="final-amount">‚Ç±0</span>
                </div>

                <div class="flex gap-2">
                    <button onclick="resetGame()" class="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-xl transition-all hover:shadow-lg transform active:scale-95">
                        Play Again üîÑ
                    </button>
                    <button onclick="revealAll()" id="reveal-btn" class="flex-1 bg-yellow-400 hover:bg-yellow-500 text-yellow-900 font-bold py-3 px-4 rounded-xl transition-all hover:shadow-lg transform active:scale-95">
                        Reveal Rest üëÄ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game Configuration
        // 20 Items Total
        const prizePool = [
            500, 200,                // Big Prizes (2)
            100, 100,                // High Mid (2)
            50, 50, 50,              // Mid (3)
            20, 20, 20, 20,          // Low Mid (4)
            10, 10, 10, 10,          // Low (4)
            5, 5, 5,                 // Pocket Change (3)
            1, 1                     // Joke (2)
        ];
        
        let currentShuffledPrizes = [];
        let gameActive = true;
        let guessesLeft = 3;
        let totalWon = 0;
        
        const seals = ['Á¶è', 'Âêâ', 'Ë¥¢', 'Ëøê', '‰πê', 'ÂØø', 'Âñú', 'Êó∫', 'Êò•', 'Áà±', 'Á¶Ñ', 'Á¶ß', 'ÂØå', 'Ë¥µ', 'ÂÆâ', 'Â∫∑', 'Âíå', 'Áæé', 'È°∫', 'ÂøÉ'];

        const grid = document.getElementById('game-grid');
        const totalDisplay = document.getElementById('total-display');
        const guessesContainer = document.getElementById('guesses-container');

        function initGame() {
            // Reset State
            currentShuffledPrizes = [...prizePool].sort(() => Math.random() - 0.5);
            const shuffledSeals = [...seals].sort(() => Math.random() - 0.5);
            gameActive = true;
            guessesLeft = 3;
            totalWon = 0;
            
            // Reset UI
            grid.innerHTML = '';
            totalDisplay.innerText = "‚Ç±0";
            totalDisplay.classList.remove('score-update');
            updateGuessesUI();

            // Hide modal
            const overlay = document.getElementById('celebration-overlay');
            overlay.classList.add('hidden');
            overlay.classList.remove('opacity-100');
            document.getElementById('modal-content').classList.remove('scale-100');

            // Generate HTML for 20 Ampaos
            currentShuffledPrizes.forEach((amount, index) => {
                
                // Determine bill style class
                let billClass = 'bill-low';
                if (amount >= 20) billClass = 'bill-mid';
                if (amount >= 100) billClass = 'bill-high';

                const scene = document.createElement('div');
                scene.className = 'scene';
                
                scene.innerHTML = `
                    <div class="ampao group" id="ampao-${index}" onclick="openAmpao(${index}, ${amount})">
                        <div class="ampao-front">
                            <div class="pattern"></div>
                            <div class="gold-seal group-hover:scale-110 transition-transform text-xs">${shuffledSeals[index]}</div>
                        </div>
                        <div class="ampao-back">
                            <div class="money-bill ${billClass}">
                                <span class="text-[10px] font-bold uppercase tracking-widest mb-1 opacity-60">Peso</span>
                                <span class="text-xl md:text-2xl font-black">‚Ç±${amount}</span>
                            </div>
                        </div>
                    </div>
                `;
                grid.appendChild(scene);
            });
        }

        function updateGuessesUI() {
            guessesContainer.innerHTML = '';
            for (let i = 0; i < 3; i++) {
                if (i < guessesLeft) {
                    guessesContainer.innerHTML += '<span class="text-xl animate-pulse">üßß</span>';
                } else {
                    guessesContainer.innerHTML += '<span class="text-xl opacity-20 grayscale">üßß</span>';
                }
            }
        }

        function openAmpao(index, amount) {
            if (!gameActive || guessesLeft <= 0) return;
            
            const selectedAmpao = document.getElementById(`ampao-${index}`);
            // Check if already opened (ignore click)
            if (selectedAmpao.classList.contains('opened')) return;

            // Execute Move
            selectedAmpao.classList.add('opened');
            
            // Trigger individual effect based on amount
            if (amount >= 100) triggerConfetti(false); 

            // Update State
            totalWon += amount;
            guessesLeft--;

            // Update UI
            updateGuessesUI();
            
            // Animate Score
            totalDisplay.innerText = "‚Ç±" + totalWon;
            totalDisplay.classList.remove('score-update');
            void totalDisplay.offsetWidth; // trigger reflow
            totalDisplay.classList.add('score-update');

            // Check Game Over
            if (guessesLeft === 0) {
                gameActive = false;
                
                // Dim remaining unpicked items
                document.querySelectorAll('.ampao:not(.opened)').forEach(el => {
                    el.classList.add('disabled');
                });

                // Big celebration
                setTimeout(() => {
                    triggerConfetti(true);
                    showFinalResult();
                }, 1000);
            }
        }

        function showFinalResult() {
            const overlay = document.getElementById('celebration-overlay');
            const modalContent = document.getElementById('modal-content');
            const resultTitle = document.getElementById('result-title');
            const messageEl = document.getElementById('quirky-message');
            const emojiEl = document.getElementById('emoji-result');
            const modalGlow = document.getElementById('modal-bg-glow');

            document.getElementById('final-amount').innerText = "‚Ç±" + totalWon;

            // Logic for final messages
            if (totalWon >= 500) {
                resultTitle.innerText = "JACKPOT MASTER!";
                resultTitle.className = "text-2xl md:text-3xl text-green-600 mb-2 font-black";
                messageEl.innerText = "Dinner is on you tonight! üçï";
                emojiEl.innerText = "ü§ë";
                modalGlow.className = "absolute inset-0 opacity-20 bg-green-400";
            } else if (totalWon >= 200) {
                resultTitle.innerText = "Big Winner!";
                resultTitle.className = "text-2xl md:text-3xl text-blue-600 mb-2 font-black";
                messageEl.innerText = "Solid haul! Treat yourself. üç¶";
                emojiEl.innerText = "üòé";
                modalGlow.className = "absolute inset-0 opacity-20 bg-blue-400";
            } else if (totalWon >= 50) {
                resultTitle.innerText = "Not Bad!";
                resultTitle.className = "text-2xl md:text-3xl text-yellow-600 mb-2 font-black";
                messageEl.innerText = "Enough for some snacks! üçü";
                emojiEl.innerText = "üòã";
                modalGlow.className = "absolute inset-0 opacity-20 bg-yellow-400";
            } else {
                resultTitle.innerText = "Pocket Change...";
                resultTitle.className = "text-2xl md:text-3xl text-gray-500 mb-2 font-black";
                messageEl.innerText = "Don't spend it all in one place. üêú";
                emojiEl.innerText = "üòÖ";
                modalGlow.className = "absolute inset-0 opacity-20 bg-gray-400";
            }

            // Show modal
            overlay.classList.remove('hidden');
            document.getElementById('reveal-btn').style.display = 'inline-block';
            
            requestAnimationFrame(() => {
                overlay.classList.add('opacity-100');
                modalContent.classList.add('scale-100');
            });
        }

        function revealAll() {
            const overlay = document.getElementById('celebration-overlay');
            overlay.classList.remove('opacity-100');
            document.getElementById('modal-content').classList.remove('scale-100');
            setTimeout(() => {
                overlay.classList.add('hidden');
            }, 300);

            document.querySelectorAll('.ampao').forEach(el => {
                el.classList.remove('disabled');
                el.classList.add('opened');
            });
            
            // Update header to show restart button
            const h1 = document.querySelector('h1');
            h1.innerHTML = `<button onclick="initGameAndRestoreTitle()" class="bg-red-600 text-white px-6 py-2 rounded-full text-lg hover:scale-105 transition-transform shadow-lg">Play Again? üîÑ</button>`;
        }
        
        function initGameAndRestoreTitle() {
            document.querySelector('h1').innerText = "Pick 3 Ampaos!";
            initGame();
        }

        function resetGame() {
             document.querySelector('h1').innerText = "Pick 3 Ampaos!";
            initGame();
        }

        // Particle System
        function triggerConfetti(isGrandFinale) {
            const canvas = document.createElement('canvas');
            canvas.style.position = 'fixed';
            canvas.style.inset = '0';
            canvas.style.pointerEvents = 'none';
            canvas.style.zIndex = '100';
            document.body.appendChild(canvas);
            
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            const particles = [];
            const particleCount = isGrandFinale ? 400 : 100;
            const colors = isGrandFinale 
                ? ['#22c55e', '#16a34a', '#fcd34d', '#fbbf24', '#ef4444'] 
                : ['#fcd34d', '#fbbf24', '#ffffff'];

            for (let i = 0; i < particleCount; i++) {
                particles.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    vx: (Math.random() - 0.5) * (isGrandFinale ? 40 : 20),
                    vy: (Math.random() - 0.5) * (isGrandFinale ? 40 : 20) - 5,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 8 + 4,
                    rotation: Math.random() * 360,
                    rotationSpeed: (Math.random() - 0.5) * 10,
                    gravity: 0.6,
                    drag: 0.95
                });
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                let active = false;

                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += p.gravity;
                    p.vx *= p.drag;
                    p.rotation += p.rotationSpeed;

                    if (p.y < canvas.height + 20) {
                        active = true;
                        ctx.save();
                        ctx.translate(p.x, p.y);
                        ctx.rotate(p.rotation * Math.PI / 180);
                        ctx.fillStyle = p.color;
                        ctx.fillRect(-p.size / 2, -p.size / 2, p.size, p.size);
                        ctx.restore();
                    }
                });

                if (active) {
                    requestAnimationFrame(animate);
                } else {
                    document.body.removeChild(canvas);
                }
            }
            animate();
        }

        // Start
        initGame();

    </script>
</body>
</html>
